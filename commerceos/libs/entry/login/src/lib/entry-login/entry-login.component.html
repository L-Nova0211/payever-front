<div>
  <div class="login-wrapper">
    <button class="login-button gray" type="submit" *ngIf="!displayLoginWithEmail" (click)="showLogin()">
      <div class="svg-contain">
        <svg class="login-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" height="13" viewBox="0 0 20 13" fill="none">
          <path d="M18.5326 0H1.46739C0.656973 0 0 0.656973 0 1.46739V11.413C0 12.2234 0.656973 12.8804 1.46739 12.8804H18.5326C19.343 12.8804 20 12.2234 20 11.413V1.46739C20 0.656973 19.343 0 18.5326 0Z" fill="white" />
          <mask id="mask0_266_3195" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="20" height="13">
            <path d="M18.5326 0H1.46739C0.656973 0 0 0.656973 0 1.46739V11.413C0 12.2234 0.656973 12.8804 1.46739 12.8804H18.5326C19.343 12.8804 20 12.2234 20 11.413V1.46739C20 0.656973 19.343 0 18.5326 0Z" fill="#C4C4C4" />
          </mask>
          <g mask="url(#mask0_266_3195)">
            <g filter="url(#filter0_di_266_3195)">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M20.924 13.6956L12.9698 4.83079C11.4248 3.109 8.73612 3.09841 7.17776 4.80797L-0.923828 13.6956H20.924ZM19.8914 13.2344L12.6278 5.13929C11.2647 3.62007 8.89228 3.61072 7.51726 5.11915L0.119765 13.2344H19.8914Z" fill="#D6D6D6" />
            </g>
            <g filter="url(#filter1_d_266_3195)">
              <path d="M-0.32605 -0.543518H20.3261L12.6679 7.83454C11.1948 9.44607 8.65321 9.43608 7.19284 7.81302L-0.32605 -0.543518Z" fill="#F4F4F4" />
            </g>
            <g filter="url(#filter2_i_266_3195)">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M-0.32605 -0.543518L7.19284 7.81303C8.65321 9.43608 11.1948 9.44606 12.6679 7.83453L20.3261 -0.543518H-0.32605ZM0.650021 -0.108735L7.51605 7.52221C8.80461 8.95432 11.0472 8.96313 12.347 7.54119L19.3396 -0.108735H0.650021Z" fill="#DCDCDC" />
            </g>
            <g style="mix-blend-mode:multiply" opacity="0.06">
              <path style="mix-blend-mode:multiply" opacity="0.06" d="M23.9131 -7.44574H-3.91296V20.3804H23.9131V-7.44574Z" fill="url(#pattern0)" fill-opacity="0.67" />
              <path style="mix-blend-mode:multiply" opacity="0.06" d="M23.9131 -7.44574H-3.91296V20.3804H23.9131V-7.44574Z" fill="black" />
            </g>
            <g filter="url(#filter3_ii_266_3195)">
              <path d="M18.5326 0H1.46739C0.656973 0 0 0.656973 0 1.46739V11.413C0 12.2234 0.656973 12.8804 1.46739 12.8804H18.5326C19.343 12.8804 20 12.2234 20 11.413V1.46739C20 0.656973 19.343 0 18.5326 0Z" fill="#F4F4F3" fill-opacity="0.01" />
            </g>
          </g>
          <defs>
            <filter id="filter0_di_266_3195" x="-1.14122" y="3.3152" width="22.2827" height="10.8152" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix" />
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
              <feOffset dy="0.217391" />
              <feGaussianBlur stdDeviation="0.108696" />
              <feColorMatrix type="matrix" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.25 0" />
              <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_266_3195" />
              <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_266_3195" result="shape" />
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
              <feOffset dy="-0.217391" />
              <feGaussianBlur stdDeviation="0.13587" />
              <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1" />
              <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.17 0" />
              <feBlend mode="normal" in2="shape" result="effect2_innerShadow_266_3195" />
            </filter>
            <filter id="filter1_d_266_3195" x="-3.69561" y="-3.09786" width="27.3912" height="16.3194" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix" />
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
              <feOffset dy="0.815217" />
              <feGaussianBlur stdDeviation="1.68478" />
              <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.13 0" />
              <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_266_3195" />
              <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_266_3195" result="shape" />
            </filter>
            <filter id="filter2_i_266_3195" x="-0.32605" y="-0.706561" width="20.6521" height="9.74337" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix" />
              <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape" />
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
              <feOffset dy="-0.163043" />
              <feGaussianBlur stdDeviation="0.217391" />
              <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1" />
              <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0" />
              <feBlend mode="normal" in2="shape" result="effect1_innerShadow_266_3195" />
            </filter>
            <pattern id="pattern0" patternContentUnits="objectBoundingBox" width="1" height="1">
              <use xlink:href="#image0_266_3195" transform="scale(0.000769231)" />
            </pattern>
            <filter id="filter3_ii_266_3195" x="0" y="-0.48913" width="20" height="13.5869" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix" />
              <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape" />
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
              <feOffset dy="-0.48913" />
              <feGaussianBlur stdDeviation="0.244565" />
              <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1" />
              <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12 0" />
              <feBlend mode="normal" in2="shape" result="effect1_innerShadow_266_3195" />
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
              <feOffset dy="0.217391" />
              <feGaussianBlur stdDeviation="0.108696" />
              <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1" />
              <feColorMatrix type="matrix" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.25 0" />
              <feBlend mode="normal" in2="effect1_innerShadow_266_3195" result="effect2_innerShadow_266_3195" />
            </filter>
          </defs>
        </svg>
        <pe-progress-button-content class="mat-progress-spinner-light button-text">
          {{ 'actions.signin-with-email' | translate }}
        </pe-progress-button-content>
      </div>
    </button>
  </div>
  <form *ngIf="displayLoginWithEmail" class="login-wrapper" (submit)="onLoginClick($event)">
    <div style="margin-bottom: 12px">
      <peb-messages *ngIf="errorMessage" [message]="errorMessage"></peb-messages>
    </div>
    <peb-form-background *ngIf="!withoutCreds">
      <peb-form-field-input
        *ngIf="!username"
        animated="true"
        appearance="label"
        [errorMessage]="errors.email.errorMessage"
        [isFieldInvalid]="errors.email.hasError"
        [label]="'forms.personal_create.email.label' | translate"
      >
        <input (blur)="checkEmail(true)" (focus)="checkEmail(false)" [formControl]="this.form.get('email')" />
      </peb-form-field-input>
      <peb-form-field-input
        animated="true"
        appearance="label"
        [errorMessage]="errors.plainPassword.errorMessage"
        [isFieldInvalid]="errors.plainPassword.hasError"
        [label]="'forms.login.plainPassword.label' | translate"
      >
        <input [formControl]="this.form.get('plainPassword')" type="password" />
      </peb-form-field-input>
    </peb-form-background>
    <div class="pe-recaptcha-wrap-wrap">
      <div *ngIf="this.form.get('recaptchaToken')" class="pe-recaptcha-wrap">
        <pe-recaptcha [size]="'normal'" [theme]="'dark'" (verified)="onReCaptchaVerified($event)"></pe-recaptcha>
      </div>
      <button class="login-button" [class.disabled]="isLoading$ | async" [disabled]="isLoading$ | async" type="submit">
        <pe-progress-button-content class="mat-progress-spinner-light" [loading]="isLoading$ | async">
          {{ 'actions.login' | translate }}
        </pe-progress-button-content>
      </button>
      <ng-container *ngIf="!disableSignUp">
        <button class="login-button gray" (click)="redirectSignUpUrl()" type="button">
          <pe-progress-button-content class="mat-progress-spinner-light">
            {{ 'actions.signup' | translate }}
          </pe-progress-button-content>
        </button>
        <div *ngIf="!username && !withoutForgot" class="forgot-button" (click)="navigate('password')">
          {{ 'forms.login.password_forgot_link' | translate }}
        </div>
      </ng-container>
      <ng-container *ngIf="!withoutCreds">
        <div *ngIf="!username && !withoutRegister" class="row-divider">
          <div></div>
          <span>{{ 'forms.separator' | translate }}</span>
          <div></div>
        </div>
        <button
          *ngIf="!username && !withoutRegister"
          class="login-button gray"
          (click)="onRegister.emit()"
          translate
          type="button"
        >
          actions.register
        </button>
        <button *ngIf="username" class="login-button gray" (click)="navigate('login')" translate type="button">
          actions.other
        </button>
      </ng-container>
    </div>
  </form>
  <ng-container *ngIf="!disableSocialLogin && !employee">
    <div *ngIf="displayLoginWithEmail" class="or-data">
      or
    </div>
    <div *ngIf="!disableSocialLogin" class="login-wrapper">
      <button *ngIf="!facebookLoading" class="social-button" (click)="redirectFacebookUrl()">
        <div class="svg-contain">
          <svg *ngIf="!facebookLoading" class="login-icon login-icon_facebook">
            <use xlink:href="#icon-social-facebook-12"></use>
          </svg>
          <pe-progress-button-content class="mat-progress-spinner-light button-text">
            {{ 'actions.signin-with-facebook' | translate }}
          </pe-progress-button-content>
        </div>
      </button>
      <button *ngIf="facebookLoading" class="social-button">
        <div class="spinner-contain">
          <mat-spinner
            class="mat-progress-spinner-light"
            [diameter]="spinnerDiameter"
            [strokeWidth]="spinnerStrokeWidth"
          ></mat-spinner>
        </div>
      </button>
    </div>
    <div class="login-wrapper" *ngIf="!disableSocialLogin">
      <button *ngIf="!googleLoading" class="social-button" (click)="redirectGoogleUrl()">
        <div class="svg-contain">
          <svg class="login-icon_google" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19.788 10.225c0-.658-.059-1.283-.159-1.892h-9.417v3.759h5.392c-.241 1.233-.95 2.275-2 2.983v2.5h3.217c1.883-1.742 2.966-4.308 2.966-7.35z" fill="#4285F4"/>
            <path d="M10.213 20c2.7 0 4.958-.9 6.608-2.425l-3.217-2.5c-.9.6-2.041.967-3.391.967-2.609 0-4.817-1.759-5.609-4.134H1.287v2.575C2.93 17.75 6.304 20 10.212 20z" fill="#34A853"/>
            <path d="M4.604 11.908A5.803 5.803 0 0 1 4.288 10c0-.667.116-1.308.316-1.908V5.517H1.288a9.884 9.884 0 0 0 0 8.966l3.316-2.575z" fill="#FBBC05"/>
            <path d="M10.213 3.958c1.475 0 2.791.509 3.833 1.5l2.85-2.85C15.17.992 12.912 0 10.212 0 6.305 0 2.93 2.25 1.287 5.517l3.317 2.575c.792-2.375 3-4.134 5.609-4.134z" fill="#EA4335"/>
          </svg>
          <pe-progress-button-content class="mat-progress-spinner-light button-text">
            {{ 'actions.signin-with-google' | translate }}
          </pe-progress-button-content>
        </div>
      </button>
      <button  *ngIf="googleLoading" class="social-button">
        <div class="spinner-contain">
          <mat-spinner
            class="mat-progress-spinner-light"
            [diameter]="spinnerDiameter"
            [strokeWidth]="spinnerStrokeWidth"
          ></mat-spinner>
        </div>
      </button>
    </div>
  </ng-container>
</div>
